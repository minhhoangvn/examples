- name: "Clean all {{ item }} namespace"
  command: "kubectl delete namespace  {{ item }}"
  changed_when: false
  loop:
    - foo
    - bar
    - legacy
    - istio-system
    - keyfactor

  register: kubectl
  no_log: True
  ignore_errors: yes

- name: Load variable file
  include_vars:
    dir: ../vars

- name: Unzip release folder
  unarchive:
    src: "{{ playbook_dir }}/../../release/release.zip"
    dest: "{{ playbook_dir }}/../../release"

- name: "Create namespace {{ item }}"
  command: "kubectl create namespace {{ item }}"
  register: kubectl
  changed_when: false
  loop:
    - foo
    - bar
    - legacy
    - istio-system
    - keyfactor

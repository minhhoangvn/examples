- name: "Clean runtime files"
  file:
    path: "{{ playbook_dir }}/../../templates/{{ item }}.yaml"
    state: absent
  with_items:
        - proxy-config
        - credentials
        - istio-config
  changed_when: false

- name: "Clean runtime certs files"
  file:
    path: "{{ playbook_dir }}/../../templates/certs/{{ item }}"
    state: absent
  with_items:
        - custom-ca.crt
        - custom-ca.key
        - root-cert.pem
  changed_when: false

- name: "Clean istio installation files"
  file:
    path: "{{ playbook_dir }}/../../release/charts"
    state: absent
  changed_when: false

- name: "Wait istio installation files"
  wait_for:
    path: "{{ playbook_dir }}/../../release/charts"
    state: absent
  changed_when: false

- name: "Clean istio installation bin files"
  file:
    path: "{{ playbook_dir }}/../../release/istioctl-linux-amd64"
    state: absent
  changed_when: false

- name: "Wait istio installation bin files"
  wait_for:
    path: "{{ playbook_dir }}/../../release/istioctl-linux-amd64"
    state: absent
  changed_when: false